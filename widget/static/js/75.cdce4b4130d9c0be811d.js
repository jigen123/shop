webpackJsonp([75],{CNXs:function(e,t){},FHtm:function(e,t){e.exports={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"payweb"}},[t("x-header",{staticClass:"fixed-top",attrs:{title:"支付","left-options":{backText:""}}})],1)},staticRenderFns:[]}},s34f:function(e,t,r){var i=r("VU/8")(r("sAB6"),r("FHtm"),function(e){r("CNXs")},"data-v-01294f07",null);e.exports=i.exports},sAB6:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("mvHQ"),o=r.n(i),n=r("ABCa"),a=r.n(n);t.default={name:"payweb",data:function(){return{view:null,url:"",target:this.imgUrl+this.$route.query.link+"?",pay_timer:null,error:!1,myaudio:""}},mounted:function(){var e=this,t=this;window.plus&&mui.plusReady(function(){e.myaudio=plus.audio.createPlayer("/static/audio/pulse.mp3")});var r=this.$route.query;for(var i in r.payload)this.target+=i+"="+r.payload[i]+"&";this.target=this.target.substring(0,this.target.length-1),console.log(this.target),this.view=plus.webview.create(this.target,"webviewPay",{top:"67px",bottom:"0px"}),this.view.show(),this.view.onerror=function(){e.error=!0};var n=null;console.log("目标网址为："+this.target),this.view.addEventListener("progressChanged",function(i){if(100==i.progress){if(e.url=decodeURIComponent(plus.webview.getWebviewById("webviewPay").getURL()),n!==e.url){var a="^"+e.imgUrl+"api/api/payReturn",s=new RegExp(a,"i");if(console.log("当前网址为："+e.url,s),console.log(s.test(e.url)),s.test(e.url))try{var l=e.url.replace(s,"").split("?"),u=e.getUrlvalues(l[1]);console.log("数据是："+o()(u)),mui.toast(u.msg),1==u.code?(t.myaudio&&t.myaudio.play(),"join"==r.type?t.$router.replace("/kbb/joinPartner"):t.$router.replace("/kbb/CreditCardReceipts")):t.$router.go(-1)}catch(e){console.log(o()(e))}}n=e.url}},!1)},methods:{clickButton:function(e){var t=this;this.view.canBack(function(e){!t.error&&e.canBack?t.view.back():t.$router.push("/index")})},getUrlvalues:function(e){for(var t=e.split("&"),r=null,i={},o=0;o<t.length;o++)i[(r=t[o].split("="))[0]]=r[1];return i},order_req:function(e,t){}},destroyed:function(){var e=this;this.view.close(),this.view.addEventListener("close",function(){e.view=null}),this.pay_timer&&(clearInterval(this.pay_timer),this.pay_timer=null)},components:{XHeader:a.a}}}});
//# sourceMappingURL=75.cdce4b4130d9c0be811d.js.map