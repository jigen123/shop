webpackJsonp([52],{M7yH:function(t,e,n){var a=n("VU/8")(n("OHR7"),n("wF1y"),function(t){n("OATH"),n("dmGn")},"data-v-88a16a0c",null);t.exports=a.exports},OATH:function(t,e){},OHR7:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("mvHQ"),i=n.n(a),s=n("ABCa"),o=n.n(s),r=n("rHil"),l=n.n(r),u=n("1DHf"),c=n.n(u),d=n("2sLL"),h=n.n(d),p=n("YxJB"),m=n.n(p),f=n("3Lt7"),y=n.n(f),_=(n("Peep"),n("pDNl")),v=n.n(_),x=n("Bfwr"),b=n.n(x),g=n("ALGc"),k=n.n(g);e.default={name:"newTask",data:function(){return{checked:!0,type:"2",totalMoney:"",generateBtn:!0,runBtn:!0,titleData:["期数","时间","类别","金额"],tlist:[],runDay:"",taskDate:this.$route.query.value,bill_time:this.$route.query.bill_time,repay_time:this.$route.query.repay_time,credit_id:this.$route.query.credit_id,left:"",right:"",temp_id:"",bankCard:this.$route.query.bankCard,loading:!1,total:"",minMoney:"",dMoney:"",sMoney:"",payNum:""}},components:{XHeader:o.a,Group:l.a,Cell:c.a,XButton:h.a,Flexbox:m.a,FlexboxItem:y.a,XInput:v.a,Loading:b.a,XTextarea:k.a},created:function(){this.$route.query.value?this.runDay=JSON.parse(this.$route.query.value).map(function(t){return t.split("/")[2]}).join(","):this.runDay="点击选择任务日期"},mounted:function(){},methods:{chooseDate:function(){if(!this.isTrueTime(this.bill_time,this.repay_time))return mui.toast("请在账单日后，还款日前一天操作");var t=this.$route.query;return t.start=this.$moment().format("YYYY/MM/DD"),t.end=this.right.format("YYYY/MM/DD"),console.log(t,"time"),this.$router.push({name:"taskDate",query:t})},isTrueTime:function(t,e){var n=this.$moment(),a=n.get("year"),i=n.get("month")+1;t=Number(t),e=Number(e),this.left=this.$moment(a+"/"+i+"/"+(t-1)),this.right=this.$moment(a+"/"+i+"/"+e);var s=!1;return console.log(this.left,this.right),t<e?s=!!n.isBetween(this.left,this.right):(this.right=this.right.subtract(-1,"months"),s=!!n.isBetween(this.left,this.right)),s},backwrad:function(){this.$route.query.value?this.$router.go(-2):this.$router.go(-1)},generate:function(){var t=this,e={bankCard:this.bankCard,totalMoney:this.totalMoney,runDay:this.$route.query.value};this.loading=!0,this.$axios.post("/api/api/produceProgram","data="+i()(e)).then(function(e){mui.toast(e.msg),1==e.code?(t.temp_id=e.result.temp_id+"/"+new Date,t.tlist=e.result.data.list,t.total=e.result.data.total,t.dMoney=e.result.data.dMoney,t.sMoney=e.result.data.sMoney,t.minMoney=e.result.data.minMoney,t.payNum=e.result.data.payNum):mui.toast(e.msg),t.loading=!1})},run:function(){var t={bankCard:this.bankCard,temp_id:this.temp_id.split("/")[0]},e=this,n="<div class='con_fix'><span class='fl'>任务总额</span> <span class='fr'>"+this.total+"元</span></div>\n<div class='con_fix'><span class='fl'>(任务总额+费率)×0.0073</span> <span class='fr'>"+this.sMoney+"元</span></div>\n<div class='con_fix'><span class='fl'>清算服务费(3元/笔)</span> <span class='fr'>"+this.dMoney+"元</span></div>\n<div class='con_fix'><span class='fl'>银行代存(1元/笔)</span> <span class='fr'>"+this.payNum+"元</span></div>\n<div class='con_fix'><span class='fl'>总服务费</span> <span class='fr'>"+(Number(this.sMoney)+Number(this.dMoney)+Number(this.payNum)).toFixed(2)+"元</span></div>\n<div class='con_blue con_fix'><span class='fl'>最低预留额度</span> <span class='fr'>"+this.minMoney+"元</span></div>";this.$vux.confirm.show({content:n,confirmText:"去执行",cancelText:"再想想",onCancel:function(){},onConfirm:function(){e.$axios.post("/api/api/executeProgram","data="+i()(t)).then(function(t){console.log(t.data),mui.toast(t.msg),1==t.code&&e.$router.push({path:"/kbb/repay",query:{credit_id:e.credit_id}})})}})}},watch:{taskDate:function(){this.taskDate&&this.totalMoney&&(this.generateBtn=!1),this.temp_id&&(this.runBtn=!0)},totalMoney:function(){this.taskDate&&this.totalMoney&&(this.generateBtn=!1),this.temp_id&&(this.runBtn=!0)},temp_id:function(){if(this.temp_id)return this.runBtn=!1}}}},dmGn:function(t,e){},wF1y:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"newTask"}},[n("x-header",{staticClass:"fixed-top",attrs:{title:"还款","left-options":{preventGoBack:!0,backText:""}},on:{"on-click-back":t.backwrad}}),t._v(" "),n("div",{staticClass:"fixed-content"},[n("group",[n("x-textarea",{staticClass:"mytextArea",attrs:{title:"任务日期",value:t.runDay,readonly:!0,height:24,"is-link":"","show-counter":!1,rows:1,autosize:""},nativeOn:{click:function(e){t.chooseDate(e)}}}),t._v(" "),n("x-input",{attrs:{"text-align":"right","placeholder-align":"right",type:"number",title:"任务总额",placeholder:"请输入任务总额"},model:{value:t.totalMoney,callback:function(e){t.totalMoney=e},expression:"totalMoney"}})],1),t._v(" "),n("div",{staticClass:"plan"},[n("flexbox",[n("flexbox-item",[n("x-button",{attrs:{type:"primary",disabled:t.generateBtn},nativeOn:{click:function(e){t.generate(e)}}},[t._v("生成计划列表")])],1),t._v(" "),n("flexbox-item",[n("x-button",{attrs:{type:"primary",disabled:t.runBtn},nativeOn:{click:function(e){t.run(e)}}},[t._v("执行当前计划")])],1)],1)],1),t._v(" "),n("div",{staticClass:"table_cont"},[n("p",{staticClass:"plan_title"},[t._v("计划预览如下")]),t._v(" "),n("table",{attrs:{border:"1"}},[n("thead",t._l(t.titleData,function(e,a){return n("th",{key:a},[t._v(t._s(e))])})),t._v(" "),n("tbody",t._l(t.tlist,function(e,a){return t.tlist.length?n("tr",{key:a},[n("td",[t._v(t._s(a+1))]),t._v(" "),n("td",[t._v(t._s(e.chtime))]),t._v(" "),n("td",[t._v(t._s(1==e.type?"消费":"还款"))]),t._v(" "),n("td",[t._v(t._s(e.money))])]):t._e()}))])])],1),t._v(" "),n("loading",{attrs:{show:t.loading,text:"生成中..."}})],1)},staticRenderFns:[]}}});
//# sourceMappingURL=52.b80f062c3b9f5f1df9ef.js.map